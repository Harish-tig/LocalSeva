<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Profile - Local Services & Marketplace</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* Additional styles for profile page */
      .profile-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }

      .profile-header {
        display: flex;
        align-items: center;
        gap: 30px;
        margin-bottom: 30px;
      }

      .profile-avatar {
        position: relative;
        width: 120px;
        height: 120px;
      }

      .profile-avatar i {
        font-size: 120px;
        color: #6c757d;
      }

      .change-avatar-btn {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: #4e73df;
        color: white;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
      }

      .profile-info h2 {
        margin: 0 0 5px 0;
        font-size: 1.8rem;
      }

      .profile-email {
        color: #6c757d;
        margin: 0 0 10px 0;
      }

      .profile-location {
        color: #6c757d;
        margin: 0 0 15px 0;
      }

      .profile-badges {
        display: flex;
        gap: 10px;
      }

      .badge {
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .badge-primary {
        background: #e3f2fd;
        color: #1976d2;
      }

      .badge-success {
        background: #e8f5e9;
        color: #2e7d32;
      }

      .badge-secondary {
        background: #f8f9fa;
        color: #6c757d;
        border: 1px solid #dee2e6;
        margin-right: 5px;
        margin-bottom: 5px;
        display: inline-block;
      }

      .card {
        background: white;
        border-radius: 10px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .card h3 {
        margin-top: 0;
        margin-bottom: 20px;
        color: #333;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #333;
      }

      .form-control {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 1rem;
        box-sizing: border-box;
      }

      .form-control:focus {
        outline: none;
        border-color: #4e73df;
        box-shadow: 0 0 0 3px rgba(78, 115, 223, 0.1);
      }

      textarea.form-control {
        min-height: 100px;
        resize: vertical;
      }

      .form-actions {
        display: flex;
        gap: 15px;
        margin-top: 25px;
      }

      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background: #4e73df;
        color: white;
      }

      .btn-primary:hover {
        background: #3a56c4;
      }

      .btn-outline {
        background: white;
        color: #4e73df;
        border: 1px solid #4e73df;
      }

      .btn-outline:hover {
        background: #f8f9fa;
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .provider-status {
        padding: 20px;
        border-radius: 8px;
        background: #f8f9fa;
      }

      .provider-promo {
        display: flex;
        gap: 20px;
        margin-bottom: 25px;
      }

      .provider-promo i {
        font-size: 3rem;
        color: #ffc107;
      }

      .benefits-list {
        list-style: none;
        padding: 0;
        margin: 15px 0;
      }

      .benefits-list li {
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .benefits-list i {
        color: #28a745;
      }

      .provider-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .provider-badge {
        display: flex;
        align-items: center;
        gap: 10px;
        color: #28a745;
        font-weight: 600;
      }

      .provider-badge i {
        font-size: 1.5rem;
      }

      .provider-card {
        display: none; /* Hidden by default, shown when user is provider */
      }

      .provider-detail {
        margin-bottom: 15px;
      }

      .provider-detail strong {
        display: block;
        margin-bottom: 5px;
        color: #333;
      }

      .provider-detail p {
        margin: 5px 0 0 0;
        color: #555;
      }

      .provider-actions {
        display: flex;
        justify-content: flex-end;
        margin-top: 20px;
      }

      .checkbox-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 12px;
        margin-top: 10px;
      }

      .checkbox-label {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        padding: 8px;
        border-radius: 6px;
        transition: background 0.2s;
      }

      .checkbox-label:hover {
        background: #f8f9fa;
      }

      .checkbox-text {
        font-size: 0.95rem;
      }

      .price-input,
      .experience-input {
        position: relative;
        display: flex;
        align-items: center;
      }

      .currency-symbol,
      .input-suffix {
        position: absolute;
        left: 12px;
        color: #6c757d;
        font-weight: 500;
      }

      .price-input .form-control,
      .experience-input .form-control {
        padding-left: 30px;
      }

      .input-suffix {
        left: auto;
        right: 12px;
      }

      .form-description {
        color: #6c757d;
        margin-bottom: 20px;
      }

      @media (max-width: 768px) {
        .profile-header {
          flex-direction: column;
          text-align: center;
          gap: 20px;
        }

        .form-actions {
          flex-direction: column;
        }

        .checkbox-grid {
          grid-template-columns: 1fr;
        }

        .provider-promo {
          flex-direction: column;
          text-align: center;
        }

        .provider-header {
          flex-direction: column;
          gap: 15px;
          align-items: flex-start;
        }
      }
    </style>
  </head>
  <body>
    <!-- Mobile Menu Button -->
    <button id="mobileMenuBtn" class="mobile-menu-btn">
      <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2><i class="fas fa-handshake"></i> LocalConnect</h2>
        <p>Welcome, <span id="userName">User</span></p>
      </div>

      <nav class="sidebar-nav">
        <ul>
          <li>
            <a href="profile.html" class="active"
              ><i class="fas fa-user"></i> Profile</a
            >
          </li>
        </ul>

        <div class="sidebar-section">
          <h3>My Activity</h3>
          <ul>
            <li>
              <a href="my-activity.html#serviceTaken"
                ><i class="fas fa-hand-holding-heart"></i> Service Taken</a
              >
            </li>
            <li>
              <a href="my-activity.html#serviceProvided" class="provider-only"
                ><i class="fas fa-hand-holding"></i> Service Provided</a
              >
            </li>
            <li>
              <a href="my-activity.html#boughtItems"
                ><i class="fas fa-shopping-cart"></i> Buy Items</a
              >
            </li>
            <li>
              <a href="my-activity.html#soldItems"
                ><i class="fas fa-tag"></i> Sell Items</a
              >
            </li>
          </ul>
        </div>

        <div class="sidebar-section">
          <h3>My Services</h3>
          <ul>
            <li>
              <a
                href="my-services.html"
                id="myServicesLink"
                class="provider-only"
                ><i class="fas fa-briefcase"></i> Provider Dashboard</a
              >
            </li>
          </ul>
        </div>

        <div class="sidebar-section">
          <ul>
            <li>
              <a href="#" id="logoutBtn"
                ><i class="fas fa-sign-out-alt"></i> Logout</a
              >
            </li>
          </ul>
        </div>
      </nav>

      <button
        id="closeSidebar"
        class="btn btn-outline"
        style="margin: 1.5rem; display: none"
      >
        <i class="fas fa-times"></i> Close
      </button>
    </div>

    <!-- Main Content -->
    <main class="main-content">
      <div class="page-header">
        <h1>My Profile</h1>
        <div class="header-actions">
          <button id="themeToggle" class="theme-toggle">
            <i class="fas fa-moon"></i>
          </button>
        </div>
      </div>

      <div class="profile-container">
        <!-- Profile Header Card -->
        <div class="card">
          <div class="profile-header">
            <div class="profile-avatar">
              <img
                id="profileImageDisplay"
                src=""
                alt="Profile Image"
                style="
                  display: none;
                  width: 120px;
                  height: 120px;
                  border-radius: 50%;
                  object-fit: cover;
                "
              />
              <i id="profileIcon" class="fas fa-user-circle"></i>
              <button
                class="change-avatar-btn"
                title="Change photo"
                id="changeAvatarBtn"
              >
                <i class="fas fa-camera"></i>
              </button>
              <input
                type="file"
                id="avatarUpload"
                accept="image/*"
                style="display: none"
              />
            </div>
            <div class="profile-info">
              <h2 id="profileName">User</h2>
              <p class="profile-email" id="profileEmail">user@example.com</p>
              <p class="profile-location" id="profileLocation">
                <i class="fas fa-map-marker-alt"></i> Kandivali
              </p>
              <div class="profile-badges">
                <span class="badge badge-primary">Verified User</span>
                <span
                  class="badge badge-success"
                  id="providerBadge"
                  style="display: none"
                  >Service Provider</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Personal Information Card -->
        <div class="card">
          <h3>Personal Information</h3>
          <form id="profileForm">
            <div class="form-group">
              <label for="fullName" class="form-label">Full Name</label>
              <input
                type="text"
                id="fullName"
                class="form-control"
                value="User"
                readonly
                style="background-color: #f8f9fa; cursor: not-allowed"
              />
              <small
                class="form-text"
                style="color: #6c757d; display: block; margin-top: 5px"
              >
                Name cannot be changed
              </small>
            </div>

            <div class="form-group">
              <label for="email" class="form-label">Email Address</label>
              <input
                type="email"
                id="email"
                class="form-control"
                value="user@example.com"
                readonly
                style="background-color: #f8f9fa; cursor: not-allowed"
              />
              <small
                class="form-text"
                style="color: #6c757d; display: block; margin-top: 5px"
              >
                Email cannot be changed
              </small>
            </div>

            <div class="form-group">
              <label for="phone" class="form-label">Phone Number</label>
              <input
                type="tel"
                id="phone"
                class="form-control"
                placeholder="Enter your phone number"
              />
            </div>

            <div class="form-group">
              <label for="location" class="form-label">Location</label>
              <select id="location" class="form-control">
                <option value="Kandivali">Kandivali</option>
                <option value="Borivali">Borivali</option>
                <option value="Mira Road">Mira Road</option>
                <option value="Bhayender">Bhayender</option>
                <option value="Malad">Malad</option>
                <option value="Andheri">Andheri</option>
              </select>
            </div>

            <div class="form-group">
              <label for="bio" class="form-label">Bio</label>
              <textarea
                id="bio"
                class="form-control"
                rows="3"
                placeholder="Tell us about yourself..."
              ></textarea>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> Save Changes
              </button>
              <button type="button" id="changePassword" class="btn btn-outline">
                <i class="fas fa-key"></i> Change Password
              </button>
            </div>
          </form>
        </div>

        <!-- Service Provider Card (shown only if user is a provider) -->
        <div class="card provider-card" id="providerCard" style="display: none">
          <h3>Service Provider Details</h3>
          <div id="providerDetails">
            <!-- Provider details will be populated here -->
          </div>
          <div class="provider-actions">
            <button id="editProviderBtn" class="btn btn-outline">
              <i class="fas fa-edit"></i> Edit Provider Details
            </button>
          </div>
        </div>

        <!-- Service Provider Section -->
        <div class="card provider-section" id="providerSection">
          <h3>Service Provider Status</h3>

          <div id="notProviderView" class="provider-status">
            <div class="provider-promo">
              <i class="fas fa-star"></i>
              <div>
                <h4>Become a Service Provider</h4>
                <p>
                  Earn money by offering your skills and services to the
                  community.
                </p>
                <ul class="benefits-list">
                  <li>
                    <i class="fas fa-check"></i> Set your own prices and
                    schedule
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Get verified badge on your
                    profile
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Access to provider dashboard
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Priority in search results
                  </li>
                </ul>
              </div>
            </div>
            <button id="becomeProviderBtn" class="btn btn-primary">
              <i class="fas fa-user-plus"></i> Become Service Provider
            </button>
          </div>

          <div id="providerView" class="provider-status" style="display: none">
            <div class="provider-header">
              <div class="provider-badge">
                <i class="fas fa-badge-check"></i>
                <span>Verified Service Provider</span>
              </div>
            </div>
            <div class="provider-info">
              <p>
                You are a registered service provider. View your details above
                or click "Edit Provider Details" to make changes.
              </p>
            </div>
          </div>
        </div>

        <!-- Service Provider Enrollment Form (Hidden by default) -->
        <div class="card" id="enrollmentForm" style="display: none">
          <h3>Service Provider Details</h3>
          <p class="form-description">
            Provide details about the services you offer. This information will
            be visible to potential customers.
          </p>
          <form id="providerEnrollmentForm">
            <div class="form-group">
              <label class="form-label">Service Categories *</label>
              <div class="checkbox-grid">
                <label class="checkbox-label">
                  <input type="checkbox" name="categories" value="Cleaning" />
                  <span class="checkbox-text">Cleaning</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="categories" value="Carpenter" />
                  <span class="checkbox-text">Carpenter</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="categories" value="Electrical" />
                  <span class="checkbox-text">Electrical</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="categories" value="Plumbing" />
                  <span class="checkbox-text">Plumbing</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="categories" value="Ceramic" />
                  <span class="checkbox-text">Ceramic</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="categories" value="Fitness" />
                  <span class="checkbox-text">Fitness</span>
                </label>
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="categories"
                    value="Delivery and Moving"
                  />
                  <span class="checkbox-text">Delivery and Moving</span>
                </label>
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="categories"
                    value="Tutor and Education"
                  />
                  <span class="checkbox-text">Tutor and Education</span>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Service Locations *</label>
              <div class="checkbox-grid">
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="service_locations"
                    value="Kandivali"
                  />
                  <span class="checkbox-text">Kandivali</span>
                </label>
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="service_locations"
                    value="Borivali"
                  />
                  <span class="checkbox-text">Borivali</span>
                </label>
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="service_locations"
                    value="Mira Road"
                  />
                  <span class="checkbox-text">Mira Road</span>
                </label>
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="service_locations"
                    value="Bhayender"
                  />
                  <span class="checkbox-text">Bhayender</span>
                </label>
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="service_locations"
                    value="Malad"
                  />
                  <span class="checkbox-text">Malad</span>
                </label>
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="service_locations"
                    value="Andheri"
                  />
                  <span class="checkbox-text">Andheri</span>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label for="pricingType" class="form-label">Pricing Type *</label>
              <select id="pricingType" class="form-control" required>
                <option value="">Select pricing type</option>
                <option value="HOURLY">Hourly Rate</option>
                <option value="FIXED">Fixed Price</option>
                <option value="FLEXIBLE">Flexible</option>
              </select>
            </div>

            <div class="form-group">
              <label for="hourlyRate" class="form-label"
                >Average Charge per Visit (₹)</label
              >
              <div class="price-input">
                <span class="currency-symbol">₹</span>
                <input
                  type="number"
                  id="hourlyRate"
                  class="form-control"
                  placeholder="0.00"
                  step="0.01"
                  min="0"
                />
              </div>
            </div>

            <div class="form-group">
              <label for="serviceDescription" class="form-label"
                >Service Description *</label
              >
              <textarea
                id="serviceDescription"
                class="form-control"
                rows="4"
                placeholder="Describe the services you offer, your experience, and what makes you stand out..."
                required
              ></textarea>
            </div>

            <div class="form-group">
              <label for="availability" class="form-label"
                >Availability *</label
              >
              <select id="availability" class="form-control" required>
                <option value="">Select availability</option>
                <option value="full-time">Full Time</option>
                <option value="part-time">Part Time</option>
                <option value="weekends">Weekends Only</option>
                <option value="flexible">Flexible Schedule</option>
              </select>
            </div>

            <div class="form-group">
              <label for="experience" class="form-label"
                >Years of Experience</label
              >
              <div class="experience-input">
                <input
                  type="number"
                  id="experience"
                  class="form-control"
                  placeholder="Enter years of experience"
                  min="0"
                  step="0.1"
                />
                <span class="input-suffix">years</span>
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-check"></i> Save Provider Details
              </button>
              <button
                type="button"
                id="cancelEnrollment"
                class="btn btn-outline"
              >
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
      <a href="services.html">
        <i class="fas fa-th-large"></i>
        <span>Services</span>
      </a>
      <a href="add-item.html" class="sell-btn">
        <i class="fas fa-plus"></i>
      </a>
      <a href="mart.html">
        <i class="fas fa-store"></i>
        <span>Mart</span>
      </a>
    </nav>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/profile.js"></script>
    <script>
      // Simple notification function if appUtils is not available
      if (typeof appUtils === "undefined") {
        window.appUtils = {
          showNotification: function (message, type) {
            alert(message);
          },
          updateUIForUserRole: function () {
            // This would be implemented in main.js
          },
        };
      }

      // Theme toggle functionality
      document
        .getElementById("themeToggle")
        ?.addEventListener("click", function () {
          const html = document.documentElement;
          const currentTheme = html.getAttribute("data-theme");
          const newTheme = currentTheme === "light" ? "dark" : "light";
          html.setAttribute("data-theme", newTheme);
          this.innerHTML =
            newTheme === "light"
              ? '<i class="fas fa-moon"></i>'
              : '<i class="fas fa-sun"></i>';
          localStorage.setItem("theme", newTheme);
        });

      // Check for saved theme
      const savedTheme = localStorage.getItem("theme") || "light";
      document.documentElement.setAttribute("data-theme", savedTheme);
      document.getElementById("themeToggle").innerHTML =
        savedTheme === "light"
          ? '<i class="fas fa-moon"></i>'
          : '<i class="fas fa-sun"></i>';

      // Logout functionality
      document
        .getElementById("logoutBtn")
        ?.addEventListener("click", async function (e) {
          e.preventDefault();
          try {
            await api.logout();
            window.location.href = "index.html";
          } catch (error) {
            console.error("Logout error:", error);
            window.location.href = "index.html";
          }
        });

      // Mobile menu toggle
      document
        .getElementById("mobileMenuBtn")
        ?.addEventListener("click", function () {
          document.getElementById("sidebar").classList.add("active");
        });

      document
        .getElementById("closeSidebar")
        ?.addEventListener("click", function () {
          document.getElementById("sidebar").classList.remove("active");
        });
    </script>
  </body>
</html>
